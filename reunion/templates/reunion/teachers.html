{% extends 'reunion/base_class.html' %}


{% load static %}
{% block title %}
    Наши учителя
{% endblock %}

{% block content %}
    {% include 'reunion/navigation.html' %}
    <div class="header-container header-container_user-info">
        <h1>
            Наши учителя
        </h1>
    </div>
    
    <div class="gallery-container">
{#         <div class="gallery-container__header">#}
{#            <h2>Загрузи фото учителя</h2>#}
{#        </div>#}
        <div class="gallery-container__upload small-textarea">
            <form method="post" enctype="multipart/form-data" class="profile-picture__form">
                {% csrf_token %}
                {{ teachers_form}}
                <input type="hidden" name="action" value="add_photo">
                <button type="submit" class="button">ЗАГРУЗИТЬ</button>
            </form>
        </div>
        <div class="gallery-container__gallery">
            {% for photo in photos %}
                <div class="gallery-container__gallery__item">
                    <div class="gallery-container__gallery__photo" id="photo-{{ photo.id }}">
                        <div class="gallery-container__gallery__image">
                            <img src="{{ photo.image.url }}" alt="">
                        </div>
                        {% if photo.user == request.user %}
                            <div class="gallery-container__gallery__item__delete">
                                <form method="post" >
                                    {% csrf_token %}
                                    <input type="hidden" name="action" value="delete_photo">
                                    <input type="hidden" name="photo_id" value="{{ photo.id }}">
                                    <button type="submit" class="button button_delete">
                                        <img src="{% static 'reunion/img/button-delete.png' %}" alt="">
                                    </button>
                                </form>
                            </div>
                        {% endif %}

                    </div>
                    <div class="gallery-container__gallery__description">
                            {{ photo.name }}
                            <br>
                            {{ photo.subject }}
                    </div>        
                    <div class="comments comments__write-comment">
                        <form method="post" class="comment-form">
                            {% csrf_token %}
                            {{ comments_form.text }}
                            <input type="hidden" name="action" value="add_comment">
                            <input type="hidden" name="photo_id" value="{{ photo.id }}">
                            <button type="submit" class="button">Отправить</button>
                        </form>
                    </div>
                    
                    {% if photo.teacher_comments.all %}
                        <div class="comments">
                          {% for comment in photo.teacher_comments.all %}
                            <div class="comment">
                                <div class="comment__author">
                                    {{ comment.author.first_name }} {{ comment.author.last_name }} 
                                    {% if  comment.author.maiden_name %}
                                        ({{ comment.author.maiden_name }})
                                    {% endif %}
                                </div>
                                <div class="comment__date">{{ comment.created_at|date:"d.m.Y H:i" }}</div>
                                <div class="comment__comment">
                                    <div class="comment__comment__text">
                                        {{ comment.text|linebreaksbr }}
                                    </div>
                                    <div class="comment__comment__delete-button">
                                        {% if comment.author == request.user %}
                                        <form method="post" >
                                          {% csrf_token %}
                                          <input type="hidden" name="action" value="delete_comment">
                                          <input type="hidden" name="comment_id" value="{{ comment.id }}">
                                          <button type="submit" class="delete-comment">
                                              <img src="{% static 'reunion/img/button-delete-black.png' %}" alt="">
                                          </button>
                                        </form>
                                    {% endif %}
                                    </div>
                                </div>
                             </div>
                          {% endfor %}
                        
                        </div>
                    {% endif %}
                
                    <div class="decor-stroke decor-stroke_center">
                        <img class="horizontal" src="{% static 'reunion/img/stroke_hor.svg' %}" alt="">
                    </div>
                </div>
                
                
                
                
                
                
                
            {% endfor %}
            
            {% if photos %}
                <div class="gallery-container__upload small-textarea" id="load-file">
                    <form method="post" enctype="multipart/form-data" class="profile-picture__form">
                        {% csrf_token %}
                        {{ teachers_form}}
                        <input type="hidden" name="action" value="add_photo">
                        <button type="submit" class="button">ЗАГРУЗИТЬ</button>
                    </form>
                </div>
            {% endif %}
        </div>
    </div>
{% endblock %}